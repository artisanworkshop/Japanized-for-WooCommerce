(()=>{"use strict";var e={20:(e,r,o)=>{var s=o(609),c=Symbol.for("react.element"),t=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n={key:!0,ref:!0,__self:!0,__source:!0};function l(e,r,o){var s,t={},l=null,u=null;for(s in void 0!==o&&(l=""+o),void 0!==r.key&&(l=""+r.key),void 0!==r.ref&&(u=r.ref),r)a.call(r,s)&&!n.hasOwnProperty(s)&&(t[s]=r[s]);if(e&&e.defaultProps)for(s in r=e.defaultProps)void 0===t[s]&&(t[s]=r[s]);return{$$typeof:c,type:e,key:l,ref:u,props:t,_owner:i.current}}r.Fragment=t,r.jsx=l,r.jsxs=l},609:e=>{e.exports=window.React},848:(e,r,o)=>{e.exports=o(20)}},r={};function o(s){var c=r[s];if(void 0!==c)return c.exports;var t=r[s]={exports:{}};return e[s](t,t.exports,o),t.exports}o.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return o.d(r,{a:r}),r},o.d=(e,r)=>{for(var s in r)o.o(r,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:r[s]})},o.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r);const s=window.wp.hooks,c=window.wp.i18n,t=window.wp.components,a=window.wp.apiFetch;var i=o.n(a);const n=window.wp.notices,l=window.wp.element,u=window.wp.data;var m=o(848);const h=()=>{const{removeNotice:e}=(0,u.useDispatch)(n.store),r=(0,u.useSelect)(e=>e(n.store).getNotices());return 0===r.length?null:(0,m.jsx)(t.NoticeList,{notices:r,onRemove:e})},p=()=>(0,m.jsx)(t.PanelBody,{title:(0,c.__)("About Credit Card Security Guidelines","woocommerce-for-japan"),children:(0,m.jsx)(t.PanelRow,{children:(0,m.jsxs)("p",{className:"jp4wc-explain-csg",children:[(0,c.__)('Ministry of Economy, Trade and Industry has established the "Credit Card Security Guidelines" to prevent unauthorized use of credit card information. This page provides a simple check to see if your site complies with these guidelines.',"woocommerce-for-japan"),(0,m.jsx)("br",{}),(0,m.jsx)("br",{}),(0,m.jsx)("a",{href:"https://www.meti.go.jp/press/2024/03/20250305002/20250305002.html",target:"_blank",children:(0,c.__)("Credit Card Security Guidelines[6.0](2025/3/5 updated)","woocommerce-for-japan")}),(0,m.jsx)("br",{}),(0,m.jsx)("a",{href:"https://www.j-credit.or.jp/security/pdf/security_measures_for_EC_member_stores_installation_guide.pdf",target:"_blank",children:(0,c.__)("Security Measures for E-Commerce Affiliates: Implementation Guide [Appendix 20][PDF]","woocommerce-for-japan")}),(0,m.jsx)("br",{}),(0,m.jsx)("a",{href:"https://www.j-credit.or.jp/security/download/supporting_document_c.xlsx",target:"_blank",children:(0,c.__)("[Appendix 20, Appendix c] Declaration of the status of security measures implemented by EC sites (example)[Excel]","woocommerce-for-japan")}),(0,m.jsx)("br",{}),(0,m.jsx)("br",{}),(0,m.jsx)("a",{href:"https://www.j-credit.or.jp/security/document/index.html",target:"_blank",children:(0,c.__)("Related Documents","woocommerce-for-japan")})]})})}),d=({value:e,onChange:r})=>{const o=window.jp4wcSecurityCheckResult?.checkBasic||!1,s=window.jp4wcSecurityCheckResult?.checkIp||!1,a=window.jp4wcSecurityCheckResult?.checkTwoFactor||!1;let i="";return o||s||(i=(0,c.__)("Basic authentication or IP restrictions are not set for the administrator login URL.","woocommerce-for-japan")),(0,m.jsxs)(t.PanelBody,{title:(0,c.__)("Administrator screen access restrictions and administrator ID/PW management","woocommerce-for-japan"),children:[(0,m.jsx)(t.PanelRow,{children:(0,m.jsx)(t.CheckboxControl,{label:(0,c.__)("Please check this box if you have implemented security measures for your admin screen.","woocommerce-for-japan"),help:(0,c.__)("If a warning message appears below, it is possible that your security measures are not in line with the credit card security guidelines.","woocommerce-for-japan"),className:"jp4wc_security_check_admin_login",checked:e,onChange:r})}),i&&(0,m.jsx)(t.PanelRow,{children:(0,m.jsxs)("div",{className:"jp4wc-security-check__message",children:[(0,m.jsx)("h3",{children:(0,c.__)("Basic authentication or IP restrictions Check result","woocommerce-for-japan")+(0,c.__)("[Warning]","woocommerce-for-japan")}),(0,m.jsx)("p",{children:i})]})}),!1===a&&(0,m.jsx)(t.PanelRow,{children:(0,m.jsxs)("div",{className:"jp4wc-security-check__message",children:[(0,m.jsx)("h3",{children:(0,c.__)("Two-factor authentication Check result","woocommerce-for-japan")+(0,c.__)("[Warning]","woocommerce-for-japan")}),(0,m.jsx)("p",{children:(0,c.__)("There is no two-step authentication plugin installed. You need to check whether other plugins support two-step authentication for administrator accounts.","woocommerce-for-japan")})]})})]})},j=({value:e,onChange:r})=>{const o=window.jp4wcSecurityCheckResult?.checkPlugins||!1;return(0,m.jsxs)(t.PanelBody,{title:(0,c.__)("Security plugin installation","woocommerce-for-japan"),children:[(0,m.jsx)(t.PanelRow,{children:(0,m.jsx)(t.CheckboxControl,{label:(0,c.__)("Please check this box if you have installed a security plugin.","woocommerce-for-japan"),help:(0,c.__)("If a warning message appears below, it is possible that your security measures are not in line with the credit card security guidelines.","woocommerce-for-japan"),className:"jp4wc_security_check_security_plugins",checked:e,onChange:r})}),!1===o&&(0,m.jsx)(t.PanelRow,{children:(0,m.jsxs)("div",{className:"jp4wc-security-check__message",children:[(0,m.jsx)("h3",{children:(0,c.__)("Security plugin Check result","woocommerce-for-japan")+(0,c.__)("[Warning]","woocommerce-for-japan")}),(0,m.jsx)("p",{children:(0,c.__)("There is no security plugin installed. You need to check whether other plugins support security measures.","woocommerce-for-japan")})]})})]})},w=()=>{const e=window.jp4wcSecurityCheckResult?.checkPHPFlag||!1,r=window.jp4wcSecurityCheckResult?.checkUpdateFlag||!1,o=window.jp4wcSecurityCheckResult?.checkUpdateCoreMessage||"",s=window.jp4wcSecurityCheckResult?.checkUpdatePluginsMessage||"",a=window.jp4wcSecurityCheckResult?.checkUpdateThemesMessage||"";return(0,m.jsxs)(t.PanelBody,{title:(0,c.__)("Vulnerability Assessment","woocommerce-for-japan"),children:[(0,m.jsx)(t.PanelRow,{children:(0,m.jsx)("p",{children:(0,c.__)("If you see the following warning message, your system may not be protected from vulnerabilities. Please check the details.","woocommerce-for-japan")})}),(0,m.jsx)(t.PanelRow,{children:(0,m.jsxs)("div",{className:"jp4wc-security-check__message",children:[!1===e&&(0,m.jsx)("h3",{children:(0,c.__)("PHP version Check result","woocommerce-for-japan")+(0,c.__)("[Warning]","woocommerce-for-japan")}),(0,m.jsx)("p",{children:window.jp4wcSecurityCheckResult?.checkPHPMessage})]})}),!1===r&&(0,m.jsx)(t.PanelRow,{children:(0,m.jsxs)("div",{className:"jp4wc-security-check__message",children:[(0,m.jsx)("h3",{children:(0,c.__)("Update Check result","woocommerce-for-japan")+(0,c.__)("[Warning]","woocommerce-for-japan")}),o&&(0,m.jsx)("div",{children:o}),s&&(0,m.jsx)("div",{children:s}),a&&(0,m.jsx)("div",{children:a})]})})]})},_=()=>{const[e,r]=(0,l.useState)(!1),[o,s]=(0,l.useState)({current:0,total:0,suspiciousFiles:[]}),[a,n]=(0,l.useState)(!1),[u,h]=(0,l.useState)(""),p=()=>{i()({path:"/jp4wc/v1/security-process-scan-batch",method:"POST"}).then(e=>{void 0!==e.current&&s(e),e.complete?(n(!0),r(!1)):setTimeout(p,500)}).catch(e=>{h((0,c.__)("Scan progress error: ","woocommerce-for-japan")+e.message),r(!1)})};let d=0;return o.total>0&&(d=Math.round(o.current/o.total*100)),(0,m.jsxs)(t.PanelBody,{title:(0,c.__)("Malware security quick check (PHP files only)","woocommerce-for-japan"),children:[(0,m.jsxs)(t.PanelRow,{className:"jp4wc-security-check__malware-scan",children:[(0,c.__)("Check for suspicious PHP files in the wp-content folder in WordPress.","woocommerce-for-japan"),(0,m.jsx)("br",{}),(0,c.__)("This is a simple test, but if you have never checked your server for malware before, please try it. It may take a few minutes to process, so please do not move away from the page.","woocommerce-for-japan"),(0,m.jsx)("br",{}),(0,c.__)("Suspicious files are judged based on whether the following codes are embedded in them: ","woocommerce-for-japan"),"(eval, gzinflate, str_rot13, shell_exec, system, exec)",(0,m.jsx)("br",{}),(0,c.__)("Note: Ideally, you should check all files, not just PHP files.","woocommerce-for-japan")]}),(0,m.jsxs)(t.PanelRow,{className:"jp4wc-security-check__malware-scan",children:[u&&(0,m.jsx)("p",{style:{color:"red"},children:u}),!e&&!a&&(0,m.jsx)(t.Button,{onClick:()=>{r(!0),h(""),i()({path:"/jp4wc/v1/security-start-scan",method:"POST"}).then(e=>{e.totalFiles&&p()}).catch(e=>{h((0,c.__)("Scan start failed: ","woocommerce-for-japan")+e.message),r(!1)})},className:"is-primary",children:(0,c.__)("Start Scan","woocommerce-for-japan")}),e&&(0,m.jsxs)("div",{children:[(0,m.jsxs)("p",{children:[(0,c.__)("Scanning: ","woocommerce-for-japan"),o.current," / ",o.total," (",d,"%)"]}),(0,m.jsx)(t.ProgressBar,{value:d}),(0,m.jsx)(t.Spinner,{})]}),a&&(0,m.jsxs)("div",{className:"jp4wc-security-check__malware-scan-results",children:[(0,m.jsx)("p",{children:(0,m.jsx)("b",{children:(0,c.__)("Scan Complete!","woocommerce-for-japan")})}),o.suspiciousFiles.length>0?(0,m.jsxs)("div",{children:[(0,m.jsxs)("h3",{children:[(0,c.__)("Suspicious files:","woocommerce-for-japan"),"(",o.suspiciousFiles.length,")"]}),(0,m.jsx)("ul",{children:o.suspiciousFiles.map((e,r)=>(0,m.jsx)("li",{children:(0,m.jsxs)("p",{children:[e.file,(0,m.jsx)("br",{}),(0,m.jsxs)("small",{children:[(0,c.__)("Detected pattern:","woocommerce-for-japan")," ",e.pattern,", ",(0,c.__)("Line#:","woocommerce-for-japan")," ",e.line,(0,m.jsx)("br",{}),(0,c.__)("Line:","woocommerce-for-japan")," ",e.line_code&&e.line_code.length>100?e.line_code.substring(0,100)+"...":e.line_code]})]})},r))}),(0,c.__)("The number and line number within the file will be displayed so you can verify that the contents are safe.","woocommerce-for-japan"),(0,m.jsx)("br",{}),(0,c.__)("If a line is longer than 100 characters, only the first 100 characters are displayed.","woocommerce-for-japan"),(0,m.jsx)("br",{}),(0,c.__)("If you have any questions, please contact the developer.","woocommerce-for-japan")]}):(0,m.jsx)("p",{className:"no_suspicious_files",children:(0,m.jsx)("b",{children:(0,c.__)("No suspicious files were found.","woocommerce-for-japan")})})]})]})]})},f=()=>{const e=window.jp4wcSecurityCheckResult?.salesLast30Days||!1;return(0,m.jsxs)(t.PanelBody,{title:(0,c.__)("🚀✨[Limited time offer! Safe and secure professional support]✨🚀","woocommerce-for-japan"),className:"jp4wc-security-check__promotion",children:[(0,m.jsxs)(t.PanelRow,{children:[(0,c.__)("🔒 If you're worried about security measures, this is a must-see!","woocommerce-for-japan"),(0,m.jsx)("br",{}),(0,c.__)("Our experts will do their best to protect your business💼.","woocommerce-for-japan"),(0,m.jsx)("br",{})]}),(0,m.jsxs)(t.PanelRow,{children:[e>1e6&&(0,m.jsx)(t.Button,{href:"https://wc4jp-pro.work/about-security-service/?utm_source=plugin&utm_medium=link&utm_campaign=jp4wc",target:"_blank",rel:"noopener noreferrer",className:"jp4wc-security-check__promotion-button",children:(0,c.__)("Security measures for WooCommerce","woocommerce-for-japan")}),e<1e6&&(0,m.jsxs)("div",{children:[(0,m.jsx)("h3",{children:(0,c.__)("💰 Exclusive for stores aiming to achieve their dream of 1 million yen in monthly sales! 💰","woocommerce-for-japan")}),(0,c.__)("🎉 In addition, this special service is only available on a limited number of sites! 🎉","woocommerce-for-japan"),(0,m.jsx)("br",{}),(0,c.__)("🔮 As a smart investment for the future, you can achieve reliable security measures for only 1,000 yen per month for the first year 💪!","woocommerce-for-japan"),(0,m.jsx)("br",{}),(0,c.__)("🔥 Don't miss this chance to take your store operations to the next level right now! 🔥","woocommerce-for-japan"),(0,m.jsx)("br",{}),(0,m.jsxs)(t.Button,{href:"https://wc4jp-pro.work/about-security-service/descript-starter-plan/?utm_source=plugin&utm_medium=link&utm_campaign=jp4wc",target:"_blank",rel:"noopener noreferrer",className:"jp4wc-security-check__promotion-button",children:[(0,c.__)("Starter Plan: ","woocommerce-for-japan"),(0,c.__)("Security measures for WooCommerce","woocommerce-for-japan")]})]})]})]})},y=()=>(0,m.jsx)(t.__experimentalHeading,{level:1,children:(0,c.__)("Credit Card Security Guidelines Check","woocommerce-for-japan")}),x=({onClick:e})=>(0,m.jsx)("div",{className:"jp4wc-save",children:(0,m.jsx)(t.Button,{className:"jp4wc-save jp4wc-button is-primary",onClick:e,children:(0,c.__)("Save","woocommerce-for-japan")})}),g=()=>{const{checkAdminLogin:e,setCheckAdminLogin:r,checkSeucirytPluigns:o,setCheckSeucirytPluigns:s,saveSettings:a}=(()=>{const[e,r]=(0,l.useState)(),[o,s]=(0,l.useState)(),{createErrorNotice:t}=(0,u.useDispatch)(n.store),{createSuccessNotice:a}=(0,u.useDispatch)(n.store);return(0,l.useEffect)(()=>{i()({path:"/wp/v2/settings"}).then(e=>{r(e.jp4wc_security_settings.checkAdminLogin),s(e.jp4wc_security_settings.checkSeucirytPluigns)})},[]),{checkAdminLogin:e,setCheckAdminLogin:r,checkSeucirytPluigns:o,setCheckSeucirytPluigns:s,saveSettings:()=>{i()({path:"/wp/v2/settings",method:"POST",data:{jp4wc_security_settings:{checkAdminLogin:e,checkSeucirytPluigns:o}}}).then(()=>{a((0,c.__)("Settings saved.","woocommerce-for-japan"))}).catch(e=>{t(e.message)})}}})();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(y,{}),(0,m.jsx)(h,{}),(0,m.jsxs)(t.Panel,{children:[(0,m.jsx)(p,{}),(0,m.jsx)(f,{}),(0,m.jsx)(d,{value:e,onChange:e=>r(e)}),(0,m.jsx)(j,{value:o,onChange:e=>s(e)}),(0,m.jsx)(w,{}),(0,m.jsx)(_,{})]}),(0,m.jsx)(x,{onClick:a})]})},k=()=>(0,m.jsx)(g,{});(0,s.addFilter)("woocommerce_admin_pages_list","security-check",e=>(e.push({container:k,path:"/jp4wc-security-check",breadcrumbs:[(0,c.__)("Simple check to comply with credit card security guidelines (established by the Ministry of Economy, Trade and Industry)","woocommerce-for-japan")],navArgs:{id:"jp4wc-security-check"}}),e))})();